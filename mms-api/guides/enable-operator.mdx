---
title: 'Enable Controller as operator'
description: 'One-time setup to enable cancel and claim functionality.'
---

To execute `CANCEL` and `CLAIM` actions via the Controller, you must first approve it as an **order operator**.

## One-time setup

Call `setOrderOperator` on the BookManager contract:

```typescript
import { getContract } from 'viem';

// BookManager ABI (partial)
const bookManagerAbi = [
  {
    inputs: [
      { name: 'operator', type: 'address' },
      { name: 'approved', type: 'bool' },
    ],
    name: 'setOrderOperator',
    outputs: [],
    stateMutability: 'nonpayable',
    type: 'function',
  },
] as const;

// Get contract instances
const bookManager = getContract({
  address: BOOK_MANAGER_ADDRESS,
  abi: bookManagerAbi,
  client: walletClient,
});

// Approve Controller as operator
const txHash = await bookManager.write.setOrderOperator([
  CONTROLLER_ADDRESS,
  true, // true = approve, false = revoke
]);

console.log('Transaction:', txHash);
```

## Verify approval

After the transaction confirms, check the approval status:

```typescript
const isApproved = await bookManager.read.isOrderOperator([
  YOUR_ADDRESS,
  CONTROLLER_ADDRESS,
]);

console.log('Controller is approved:', isApproved);
```

## Using CANCEL and CLAIM

Once approved, the Controller can process your cancel and claim actions:

```typescript
import { encodeAbiParameters } from 'viem';

// Cancel an order
const cancelTypes = [
  { name: 'id', type: 'uint256' },
  { name: 'leftQuoteAmount', type: 'uint256' },
  { name: 'owner', type: 'address' },
] as const;

const cancelData = encodeAbiParameters(cancelTypes, [
  orderId,
  0n, // 0 = full cancel
  YOUR_ADDRESS,
]);

await controller.write.execute([
  [Action.CANCEL], // actionList
  [cancelData], // paramsDataList
  [], // erc20PermitParamsList
  BigInt(Math.floor(Date.now() / 1000) + 300), // deadline (5 min)
]);
```

## Revoking approval

To revoke Controller approval:

```typescript
await bookManager.write.setOrderOperator([
  CONTROLLER_ADDRESS,
  false, // revoke
]);
```

## Contract addresses

Find the BookManager and Controller addresses for your network in the [Addresses reference](/mms-api/reference/addresses).

---

**Next steps:**

- [Place & cancel orders](/mms-api/guides/place-cancel)
- [Order operators concept](/mms-api/concepts/operators)
